<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Receta MÃ©dica 2025</title>

  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: #ffffff;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 210mm;
      min-height: 297mm;
      background-color: #ffffff;
      margin: 20px auto;
      padding: 20mm;
      border: 1px solid #000;
      box-sizing: border-box;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border-bottom: 2px solid #000;
      padding-bottom: 10px;
    }

    .logo {
      width: 100px;
      height: auto;
      object-fit: contain;
    }

    .titulo {
      text-align: center;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 16px;
      margin-top: 10px;
    }

    .folio {
      text-align: right;
      margin-top: 5px;
      font-weight: bold;
    }

    .datos {
      margin-top: 10px;
      font-size: 13px;
      line-height: 1.5;
    }

    .datos strong {
      display: inline-block;
      width: 200px;
    }

    .section {
      border: 1px solid #000;
      padding: 10px;
      margin-top: 10px;
    }

    .medicamentos {
      font-size: 13px;
      margin-top: 10px;
      border-top: 1px solid #000;
      border-bottom: 1px solid #000;
      padding: 10px 0;
    }

    .footer {
      margin-top: 20px;
      font-size: 12px;
      text-align: center;
      border-top: 1px solid #000;
      padding-top: 10px;
    }

    .formulario {
      max-width: 800px;
      background: #fff;
      margin: 30px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .formulario label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    .formulario input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .boton {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 15px;
    }

    .firma {
      margin-top: 20px;
      text-align: left;
    }

    .firma img {
      width: 180px;
      height: auto;
      border-bottom: 1px solid #000;
    }
  </style>
</head>
<body>

  <div class="formulario">
    <h3>ðŸš¨ Receta MÃ©dica 2025 - Llena los datos ðŸš¨</h3>

    <label>Nombre del paciente:</label>
    <input id="nombre" type="text">

    <label>CURP:</label>
    <input id="curp" type="text">

    <label>NSS:</label>
    <input id="nss" type="text">

    <label>DelegaciÃ³n o estado:</label>
    <input id="delegacion" type="text">

    <label>DirecciÃ³n:</label>
    <input id="direccion" type="text">

    <label>ClÃ­nica:</label>
    <input id="clinica" type="text">

    <label>Consultorio:</label>
    <input id="consultorio" type="text">

    <label>Turno:</label>
    <input id="turno" type="text">

    <label>Fecha:</label>
    <input id="fecha" type="date">

    <label>Medicamentos Recetados:</label>
    <input id="medicamentos" type="text" placeholder="Ejemplo: Paracetamol 500 mg, 1 cada 8 hrs">

    <label>Firma del MÃ©dico (sube imagen PNG/JPG):</label>
    <input type="file" id="firmaInput" accept="image/*">

    <button class="boton" onclick="generarReceta()">Generar Receta</button>
    <button class="boton" onclick="descargarPDF()">Descargar PDF</button>
  </div>

  <div id="receta" class="container" style="display:none;">
    <div class="header">
      <!-- Logos personalizados -->
      <img src="images/logo-izquierdo.png" class="logo" alt="Logo Izquierdo">
      <div class="titulo">
        <div>DIRECCIÃ“N DE PRESTACIONES MÃ‰DICAS</div>
        <div>RECETA INDIVIDUAL</div>
      </div>
      <img src="images/logo-derecho.png" class="logo" alt="Logo Derecho">
    </div>

    <div class="folio">
      <div>Folio: <span id="folio"></span></div>
      <div>Fecha: <span id="fechaReceta"></span></div>
    </div>

    <div class="datos">
      <strong>Nombre del Paciente:</strong> <span id="outNombre"></span><br>
      <strong>CURP:</strong> <span id="outCurp"></span><br>
      <strong>NSS:</strong> <span id="outNss"></span><br>
      <strong>DelegaciÃ³n:</strong> <span id="outDelegacion"></span><br>
      <strong>DirecciÃ³n:</strong> <span id="outDireccion"></span><br>
      <strong>ClÃ­nica:</strong> <span id="outClinica"></span><br>
      <strong>Consultorio:</strong> <span id="outConsultorio"></span><br>
      <strong>Turno:</strong> <span id="outTurno"></span><br>
    </div>

    <div class="medicamentos">
      <strong>Medicamentos Recetados:</strong>
      <p id="outMedicamentos"></p>
    </div>

    <div class="firma">
      <strong>Nombre y Firma del MÃ©dico:</strong><br>
      <img id="firmaPreview" alt="Firma del mÃ©dico" style="display:none;">
    </div>

    <div class="footer">
      <p>ACUDIR EN ESTE MOMENTO A LA FARMACIA</p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  <script>
    function generarFolio() {
      const hoy = new Date();
      return hoy.getFullYear().toString() +
             (hoy.getMonth()+1).toString().padStart(2,'0') +
             hoy.getDate().toString().padStart(2,'0') +
             Math.floor(Math.random()*9000+1000);
    }

    let firmaDataURL = "";

    document.getElementById("firmaInput").addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          firmaDataURL = evt.target.result;
          const img = document.getElementById("firmaPreview");
          img.src = firmaDataURL;
          img.style.display = "block";
        };
        reader.readAsDataURL(file);
      }
    });

    function generarReceta() {
      document.getElementById("receta").style.display = "block";

      document.getElementById("folio").textContent = generarFolio();
      document.getElementById("fechaReceta").textContent = document.getElementById("fecha").value || new Date().toLocaleDateString();
      document.getElementById("outNombre").textContent = document.getElementById("nombre").value;
      document.getElementById("outCurp").textContent = document.getElementById("curp").value;
      document.getElementById("outNss").textContent = document.getElementById("nss").value;
      document.getElementById("outDelegacion").textContent = document.getElementById("delegacion").value;
      document.getElementById("outDireccion").textContent = document.getElementById("direccion").value;
      document.getElementById("outClinica").textContent = document.getElementById("clinica").value;
      document.getElementById("outConsultorio").textContent = document.getElementById("consultorio").value;
      document.getElementById("outTurno").textContent = document.getElementById("turno").value;
      document.getElementById("outMedicamentos").textContent = document.getElementById("medicamentos").value;

      if (firmaDataURL) {
        document.getElementById("firmaPreview").src = firmaDataURL;
        document.getElementById("firmaPreview").style.display = "block";
      }
    }

    function descargarPDF() {
      const element = document.getElementById("receta");
      const opt = {
        margin: 0,
        filename: 'receta_medica.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }
  </script>
</body>
</html>
